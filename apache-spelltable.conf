# Apache Configuration for SpellTable
# This file shows the correct proxy configuration for the SpellTable application
# Place this in /etc/apache2/sites-available/ and enable with a2ensite

<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName spelltable.paulhoeller.at
    ServerAlias spelltable.paulhoeller.at
    ServerAdmin admin@paulhoeller.at

    ProxyPreserveHost On

    # --- Backend API on /api ---> 8010
    ProxyPass        /api/  http://localhost:8010/
    ProxyPassReverse /api/  http://localhost:8010/

    # (Optional) If your backend uses websockets under /api/socket or similar:
    ProxyPass        /api/socket  ws://localhost:8010/api/socket
    ProxyPassReverse /api/socket  ws://localhost:8010/api/socket

    # --- Frontend on / ---> 3000
    ProxyPass        /       http://localhost:3000/
    ProxyPassReverse /       http://localhost:3000/

    ErrorLog  /var/log/apache2/spelltable.paulhoeller-error.log
    CustomLog /var/log/apache2/spelltable.paulhoeller.log combined

    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/spelltable.paulhoeller.at/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/spelltable.paulhoeller.at/privkey.pem
</VirtualHost>
</IfModule>

# HTTP to HTTPS redirect
<VirtualHost *:80>
    ServerName spelltable.paulhoeller.at
    ServerAlias spelltable.paulhoeller.at
    Redirect permanent / https://spelltable.paulhoeller.at/
</VirtualHost>
